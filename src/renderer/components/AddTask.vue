<template>
    <div class="addTask-container">
        <div class="addTask-meta" v-if="showMeta">
            <span class="addTask-meta-star">
                <svg class="starred" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g id="Web-svgs" stroke="none" stroke-width="1" fill-rule="evenodd"> <g id="starred"> <g id="Rectangle-3-+-A" transform="translate(1.000000, 0.000000)"> <path d="M3.74,18 C3.64,18 3.54,17.96 3.46,17.9 C3.28,17.76 3.2,17.54 3.28,17.34 L5.16,11.5 L0.2,7.9 C0.04,7.78 -0.04,7.56 0.02,7.34 C0.1,7.14 0.28,7 0.5,7 L6.64,7 L8.52,1.16 C8.66,0.76 9.34,0.76 9.48,1.16 L11.38,7 L17.5,7 C17.72,7 17.9,7.14 17.98,7.34 C18.04,7.56 17.96,7.78 17.8,7.9 L12.84,11.5 L14.72,17.34 C14.8,17.54 14.72,17.76 14.54,17.9 C14.38,18.02 14.14,18.02 13.96,17.9 L9,14.3 L4.04,17.9 C3.96,17.96 3.84,18 3.74,18 L3.74,18 Z M9,13.18 C9.1,13.18 9.2,13.2 9.3,13.28 L13.3,16.18 L11.78,11.46 C11.7,11.26 11.78,11.04 11.96,10.92 L15.96,8 L11,8 C10.8,8 10.6,7.86 10.54,7.66 L9,2.94 L7.46,7.66 C7.4,7.86 7.22,8 7,8 L2.04,8 L6.04,10.92 C6.22,11.04 6.3,11.26 6.22,11.46 L4.7,16.18 L8.7,13.28 C8.8,13.2 8.9,13.18 9,13.18 L9,13.18 Z" id="C"></path> <path d="M3.74,18 C3.64,18 3.54,17.96 3.46,17.9 C3.28,17.76 3.2,17.54 3.28,17.34 L5.16,11.5 L0.2,7.9 C0.04,7.78 -0.04,7.56 0.02,7.34 C0.1,7.14 0.28,7 0.5,7 L6.64,7 L8.52,1.16 C8.66,0.76 9.34,0.76 9.48,1.16 L11.38,7 L17.5,7 C17.72,7 17.9,7.14 17.98,7.34 C18.04,7.56 17.96,7.78 17.8,7.9 L12.84,11.5 L14.72,17.34 C14.8,17.54 14.72,17.76 14.54,17.9 C14.38,18.02 14.14,18.02 13.96,17.9 L9,14.3 L4.04,17.9 C3.96,17.96 3.84,18 3.74,18 L3.74,18 Z" id="D" opacity="0.06"> </path> </g> </g> </g> </svg>
            </span>
            <span class="addTask-meta-date">
                <svg class="today" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill-rule="evenodd"> <g id="today"> <path d="M2.5,7 C2.22,7 2,6.78 2,6.5 L2,3.5 C2,2.68 2.68,2 3.5,2 L16.5,2 C17.32,2 18,2.68 18,3.5 L18,6.5 C18,6.78 17.78,7 17.5,7 L2.5,7 Z M3,6 L17,6 L17,3.5 C17,3.22 16.78,3 16.5,3 L3.5,3 C3.22,3 3,3.22 3,3.5 L3,6 Z M3.5,18 C2.68,18 2,17.32 2,16.5 L2,8.5 C2,8.22 2.22,8 2.5,8 C2.78,8 3,8.22 3,8.5 L3,16.5 C3,16.78 3.22,17 3.5,17 L16.5,17 C16.78,17 17,16.78 17,16.5 L17,8.5 C17,8.22 17.22,8 17.5,8 C17.78,8 18,8.22 18,8.5 L18,16.5 C18,17.32 17.32,18 16.5,18 L3.5,18 Z" id="E"></path> </g> </g> </svg>
            </span>
        </div>
        <span class="plus-wrapper">
            <svg class="plus-small" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve"> <g> <path d="M10,10l0,6.5c-0.003,0.053 -0.008,0.103 -0.024,0.155c-0.038,0.116 -0.12,0.217 -0.226,0.278c-0.047,0.027 -0.094,0.042 -0.146,0.056c-0.052,0.008 -0.051,0.008 -0.104,0.011c-0.053,-0.003 -0.103,-0.008 -0.155,-0.024c-0.15,-0.05 -0.271,-0.171 -0.321,-0.321c-0.016,-0.052 -0.021,-0.102 -0.024,-0.155l0,-6.5l-6.5,0c-0.046,-0.002 -0.058,-0.001 -0.104,-0.011c-0.103,-0.022 -0.197,-0.076 -0.268,-0.154c-0.169,-0.188 -0.169,-0.482 0,-0.67c0.035,-0.038 0.077,-0.072 0.122,-0.098c0.078,-0.045 0.161,-0.062 0.25,-0.067l6.5,0l0,-6.5c0.005,-0.089 0.022,-0.172 0.067,-0.25c0.126,-0.219 0.406,-0.31 0.636,-0.207c0.048,0.022 0.093,0.05 0.132,0.085c0.078,0.071 0.132,0.165 0.154,0.268c0.01,0.046 0.009,0.058 0.011,0.104l0,6.5l6.5,0c0.046,0.002 0.058,0.001 0.104,0.011c0.103,0.022 0.197,0.076 0.268,0.154c0.169,0.188 0.169,0.482 0,0.67c-0.035,0.038 -0.077,0.072 -0.122,0.098c-0.078,0.045 -0.161,0.062 -0.25,0.067l-6.5,0Z"></path> </g> </svg>
        </span>
        <input class="addTask-Input" ref="newTaskInput" @keydown.enter="onKeyEnter" placeholder="添加任务..." type="text">
    </div>
</template>
<script>

import Models from '../model'
import {actionList} from '../store/actions'
import Reducers from '../store/reducers'
import moment from 'moment'

export default {
    data(){
        return {
            showMeta:true
        }
    },
    mounted(){
        const {newTaskInput} = this.$refs
        newTaskInput.onfocus = ()=>{
            this.onFocusChange(true)
        }
        newTaskInput.onblur = ()=>{
            this.onFocusChange(false)
        }
    },
    methods:{
        onKeyEnter(){
            const {newTaskInput} = this.$refs
            let value = newTaskInput.value.trim()
            if(value.length > 0){
                Reducers.dealWithAddTodoItem({
                    id:this.$store.getters.todoItemNextId,
                    status:0,
                    title:value,
                    dueDate:'',
                    subList:[],
                    date:moment().format(),
                    remark:'',
                    star:this.filterId === -3 ? 1 : 0,
                    filterId:(this.filterId === -3 || this.filterId == -2) ? -4 : this.filterId
                })
                newTaskInput.value = ''
            }
        },
        onFocusChange(bool){
            this.showMeta = bool
        },
        onAddTaskClick(){
            const {newTaskInput} = this.$refs
            newTaskInput.focus()
        }
    },
    props:{
        filterId:{
            type:[String,Number]
        }
    }
}
</script>
<style scoped>
    .addTask-container{
        background: rgba(4,131,183,0.75);
        overflow: hidden;
        position: relative;
        margin: 14px 0;
        padding: 0 12px;
        border-radius: 3px;
    }
    .addTask-Input{
        transition: none;
        color: #fff;
        font-size: 16px;
        padding: 14px 60px 14px 28px;
        background: none !important;
        text-align: left;
        width: 100%;
        line-height: 20px;
    }
    .addTask-Input::-webkit-input-placeholder{
        color:#fff;
        opacity: .7;
    }
    .plus-wrapper{
        display: block;
        width: 20px;
        height: 20px;
        position: absolute;
        opacity: .7;
        left: 10px;
        top:14px;
        cursor: pointer;
    }
    .plus-wrapper svg{
        fill:#fff;
    }
    .addTask-meta{
        transition: opacity 200ms linear;
        position: absolute;
        top: 12px;
        right: 0;
        pointer-events: none;
    }
    .addTask-meta span{
        opacity: .7;
        color: #FFF;
        margin-right: 9px;
        float: right;
    }
    .addTask-meta span svg{
        fill:#FFF;
    }
</style>

